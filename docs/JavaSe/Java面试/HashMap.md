## å‰è¨€

HashMap æ˜¯æ— è®ºåœ¨å·¥ä½œè¿˜æ˜¯é¢è¯•ä¸­éƒ½éå¸¸å¸¸è§å¸¸è€ƒçš„æ•°æ®ç»“æ„ã€‚

æ¯”å¦‚ Leetcode ç¬¬ä¸€é¢˜ Two Sum çš„æŸç§å˜ç§çš„æœ€ä¼˜è§£å°±æ˜¯éœ€è¦ç”¨åˆ° HashMap çš„ï¼Œé«˜é¢‘è€ƒé¢˜ LRU Cache æ˜¯éœ€è¦ç”¨åˆ° LinkedHashMap çš„ã€‚

HashMap ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œåº•å±‚å®ç°ä¹Ÿä¸å¤æ‚ï¼Œå…ˆæ¥çœ‹å‡ é“å¸¸è§çš„é¢è¯•é¢˜å§ã€‚ç›¸ä¿¡å¤§å®¶å¤šå¤šå°‘å°‘éƒ½èƒ½å›ç­”ä¸Šæ¥ä¸€ç‚¹ï¼Œä¸æ¸…æ¥šçš„åœ°æ–¹å°±ä»”ç»†é˜…è¯»æœ¬æ–‡å•¦ï½è¿™ç¯‡æ–‡ç« å¸¦ä½ æ·±æŒ–åˆ° HashMap çš„è€ç¥–å®—ï¼Œä¿è¯åŠæ‰“é¢è¯•å®˜![img](https://mmbiz.qpic.cn/sz_mmbiz_png/OuU9wKDTEicHCibTZCV11ibP5GBYCseSTt7Fb2WITYuWvJxUCGkMdhnosSfy13JaAwVnibz0hI6MQ0f1oxN6If5nAA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

> - == å’Œ equals() çš„åŒºåˆ«ï¼Ÿ
> - ä¸ºä»€ä¹ˆé‡å†™ equals() å°±å¿…é¡»è¦é‡å†™ hashCode()ï¼Ÿ
> - Hashtable, HashSet å’Œ HashMap çš„åŒºåˆ«å’Œè”ç³»
> - å¤„ç† hash å†²çªæœ‰å“ªäº›æ–¹æ³•ï¼ŸJava ä¸­ç”¨çš„å“ªä¸€ç§ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿå¦ä¸€ç§æ–¹æ³•ä½ åœ¨å·¥ä½œä¸­ç”¨è¿‡å—ï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ç”¨å¾—å¤šï¼Ÿ
> - å¾’æ‰‹å®ç°ä¸€ä¸ª HashMap å§

æœ¬æ–‡åˆ†ä»¥ä¸‹ç« èŠ‚ï¼š

- Set å’Œ Map å®¶æ—ç®€ä»‹

- HashMap å®ç°åŸç†

- å…³äº hashCode() å’Œ equals()

- å“ˆå¸Œå†²çªè¯¦è§£

- HashMap åŸºæœ¬æ“ä½œ

- é«˜é¢‘é¢è¯•è€ƒé¢˜åˆ†æ

  

## Set å®¶æ—

åœ¨è®² Map ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ Setã€‚

é›†åˆçš„æ¦‚å¿µæˆ‘ä»¬åˆä¸­æ•°å­¦å°±å­¦è¿‡äº†ï¼Œå°±æ˜¯é‡Œé¢ä¸èƒ½æœ‰é‡å¤å…ƒç´ ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€æ ·ã€‚

Set åœ¨ Java ä¸­æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥çœ‹åˆ°å®ƒæ˜¯ java.util åŒ…ä¸­çš„ä¸€ä¸ªé›†åˆæ¡†æ¶ç±»ï¼Œå…·ä½“çš„å®ç°ç±»æœ‰å¾ˆå¤šï¼š

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoqtFAtgCdR9DNAlXa8aGAgZdxO8icdE5K5m0WhGqHI0J4hz3TImibSzsA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

å…¶ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æœ‰ä¸‰ç§ï¼š

**HashSet**: é‡‡ç”¨ Hashmap çš„ key æ¥å‚¨å­˜å…ƒç´ ï¼Œä¸»è¦ç‰¹ç‚¹æ˜¯æ— åºçš„ï¼ŒåŸºæœ¬æ“ä½œéƒ½æ˜¯ O(1) çš„æ—¶é—´å¤æ‚åº¦ï¼Œå¾ˆå¿«ã€‚

**LinkedHashSet**: è¿™ä¸ªæ˜¯ä¸€ä¸ª HashSet + LinkedList çš„ç»“æ„ï¼Œç‰¹ç‚¹å°±æ˜¯æ—¢æ‹¥æœ‰äº† O(1) çš„æ—¶é—´å¤æ‚åº¦ï¼Œåˆèƒ½å¤Ÿä¿ç•™æ’å…¥çš„é¡ºåºã€‚

**TreeSet**: é‡‡ç”¨çº¢é»‘æ ‘ç»“æ„ï¼Œç‰¹ç‚¹æ˜¯å¯ä»¥æœ‰åºï¼Œå¯ä»¥ç”¨è‡ªç„¶æ’åºæˆ–è€…è‡ªå®šä¹‰æ¯”è¾ƒå™¨æ¥æ’åºï¼›ç¼ºç‚¹å°±æ˜¯æŸ¥è¯¢é€Ÿåº¦æ²¡æœ‰ HashSet å¿«ã€‚

## Map å®¶æ—

Map æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ (Key - Value pairs)ï¼Œå…¶ä¸­ key æ˜¯ä¸å¯ä»¥é‡å¤çš„ï¼Œæ¯•ç«Ÿ set ä¸­çš„ key è¦å­˜åœ¨è¿™é‡Œé¢ã€‚

é‚£ä¹ˆä¸ Set ç›¸å¯¹åº”çš„ï¼ŒMap ä¹Ÿæœ‰è¿™ä¸‰ä¸ªå®ç°ç±»ï¼š

**HashMap**: ä¸ HashSet å¯¹åº”ï¼Œä¹Ÿæ˜¯æ— åºçš„ï¼ŒO(1)ã€‚

**LinkedHashMap**: è¿™æ˜¯ä¸€ä¸ªã€ŒHashMap + åŒå‘é“¾è¡¨ã€çš„ç»“æ„ï¼Œè½è„šç‚¹æ˜¯ HashMapï¼Œæ‰€ä»¥æ—¢æ‹¥æœ‰ HashMap çš„æ‰€æœ‰ç‰¹æ€§è¿˜èƒ½æœ‰é¡ºåºã€‚

**TreeMap**: æ˜¯æœ‰åºçš„ï¼Œæœ¬è´¨æ˜¯ç”¨äºŒå‰æœç´¢æ ‘æ¥å®ç°çš„ã€‚

## HashMap å®ç°åŸç†

å¯¹äº HashMap ä¸­çš„æ¯ä¸ª keyï¼Œé¦–å…ˆé€šè¿‡ hash function è®¡ç®—å‡ºä¸€ä¸ª hash å€¼ï¼Œè¿™ä¸ªhashå€¼å°±ä»£è¡¨äº†åœ¨ buckets é‡Œçš„ç¼–å·ï¼Œè€Œ buckets å®é™…ä¸Šæ˜¯ç”¨æ•°ç»„æ¥å®ç°çš„ï¼Œæ‰€ä»¥æŠŠè¿™ä¸ªæ•°å€¼æ¨¡ä¸Šæ•°ç»„çš„é•¿åº¦å¾—åˆ°å®ƒåœ¨æ•°ç»„çš„ indexï¼Œå°±è¿™æ ·æŠŠå®ƒæ”¾åœ¨äº†æ•°ç»„é‡Œã€‚

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoETAboR5VVAicnCjocINtHQeeM9xvibiawfBpwibDu6TAiak5OIvOQV0Dsrw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

é‚£ä¹ˆè¿™é‡Œæœ‰å‡ ä¸ªé—®é¢˜ï¼š

> å¦‚æœä¸åŒçš„å…ƒç´ ç®—å‡ºäº†ç›¸åŒçš„å“ˆå¸Œå€¼ï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆå­˜æ”¾å‘¢ï¼Ÿ

ç­”ï¼šè¿™å°±æ˜¯**å“ˆå¸Œç¢°æ’**ï¼Œå³å¤šä¸ª key å¯¹åº”äº†åŒä¸€ä¸ªæ¡¶ã€‚

> HashMap ä¸­æ˜¯å¦‚ä½•ä¿è¯å…ƒç´ çš„å”¯ä¸€æ€§çš„å‘¢ï¼Ÿå³ç›¸åŒçš„å…ƒç´ ä¼šä¸ä¼šç®—å‡ºä¸åŒçš„å“ˆå¸Œå€¼å‘¢ï¼Ÿ

ç­”ï¼šé€šè¿‡ **hashCode()** å’Œ **equals()** æ–¹æ³•æ¥ä¿è¯å…ƒç´ çš„å”¯ä¸€æ€§ã€‚

> å¦‚æœ pairs å¤ªå¤šï¼Œbuckets å¤ªå°‘æ€ä¹ˆç ´ï¼Ÿ

ç­”ï¼š**Rehasing**. ä¹Ÿå°±æ˜¯ç¢°æ’å¤ªå¤šçš„æ—¶å€™ï¼Œä¼šæŠŠæ•°ç»„æ‰©å®¹è‡³ä¸¤å€ï¼ˆé»˜è®¤ï¼‰ã€‚æ‰€ä»¥è¿™æ ·è™½ç„¶ hash å€¼æ²¡æœ‰å˜ï¼Œä½†æ˜¯å› ä¸ºæ•°ç»„çš„é•¿åº¦å˜äº†ï¼Œæ‰€ä»¥ç®—å‡ºæ¥çš„ index å°±å˜äº†ï¼Œå°±ä¼šè¢«åˆ†é…åˆ°ä¸åŒçš„ä½ç½®ä¸Šäº†ï¼Œå°±ä¸ç”¨æŒ¤åœ¨ä¸€èµ·äº†ï¼Œå°ä¼™ä¼´ä»¬æˆ‘ä»¬æ±Ÿæ¹–å†è§ï½

> é‚£ä»€ä¹ˆæ—¶å€™ä¼š rehashing å‘¢ï¼Ÿä¹Ÿå°±æ˜¯æ€ä¹ˆè¡¡é‡æ¡¶é‡Œæ˜¯ä¸æ˜¯è¶³å¤Ÿ**æ‹¥æŒ¤**è¦æ‰©å®¹äº†å‘¢ï¼Ÿ

ç­”ï¼š**load factor**. å³ç”¨ pair çš„æ•°é‡é™¤ä»¥ buckets çš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯**å¹³å‡æ¯ä¸ªæ¡¶é‡Œè£…å‡ å¯¹**ã€‚Java ä¸­é»˜è®¤å€¼æ˜¯ **0.75f**ï¼Œå¦‚æœè¶…è¿‡äº†è¿™ä¸ªå€¼å°±ä¼š **rehashing**.

### å…³äº hashCode() å’Œ equals()

å¦‚æœ key çš„ hashCode() å€¼ç›¸åŒï¼Œé‚£ä¹ˆæœ‰å¯èƒ½æ˜¯è¦å‘ç”Ÿ hash collision äº†ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯çœŸçš„é‡åˆ°äº†å¦ä¸€ä¸ªè‡ªå·±ã€‚é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­å‘¢ï¼Ÿç»§ç»­ç”¨ equals() æ¥æ¯”è¾ƒã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œ

> hashCode() å†³å®šäº† key æ”¾åœ¨è¿™ä¸ªæ¡¶é‡Œçš„ç¼–å·ï¼Œä¹Ÿå°±æ˜¯åœ¨æ•°ç»„é‡Œçš„ indexï¼›

> equals() æ˜¯ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ª object æ˜¯å¦ç›¸åŒçš„ã€‚

é‚£ä¹ˆè¯¥å¦‚ä½•å›ç­”è¿™é“**ç»å…¸é¢è¯•é¢˜**ï¼š

**ä¸ºä»€ä¹ˆé‡å†™ equals() æ–¹æ³•ï¼Œä¸€å®šè¦é‡å†™ hashCode() å‘¢ï¼Ÿ**

ç­”ï¼šé¦–å…ˆæˆ‘ä»¬æœ‰ä¸€ä¸ªå‡è®¾ï¼šä»»ä½•ä¸¤ä¸ª object çš„ hashCode éƒ½æ˜¯ä¸åŒçš„ã€‚

é‚£ä¹ˆåœ¨è¿™ä¸ªæ¡ä»¶ä¸‹ï¼Œæœ‰ä¸¤ä¸ª object æ˜¯ç›¸ç­‰çš„ï¼Œé‚£å¦‚æœä¸é‡å†™ hashCode()ï¼Œç®—å‡ºæ¥çš„å“ˆå¸Œå€¼éƒ½ä¸ä¸€æ ·ï¼Œå°±ä¼šå»åˆ°ä¸åŒçš„ buckets äº†ï¼Œå°±è¿·å¤±åœ¨èŒ«èŒ«äººæµ·ä¸­äº†ï¼Œå†ä¹Ÿæ— æ³•ç›¸è®¤ï¼Œå°±å’Œ equals() æ¡ä»¶çŸ›ç›¾äº†ï¼Œè¯æ¯•ã€‚

æ’’èŠ±ï½ï½ğŸ‰ğŸ‰ğŸ‰

æ¥ä¸‹æ¥æˆ‘ä»¬å†å¯¹è¿™ä¸¤ä¸ªæ–¹æ³•ä¸€æ¢ç©¶ç«Ÿï¼š

å…¶å® hashCode() å’Œ equals() æ–¹æ³•éƒ½æ˜¯åœ¨ Object class è¿™ä¸ªè€ç¥–å®—é‡Œå®šä¹‰çš„ï¼ŒObject æ˜¯æ‰€æœ‰ Java ä¸­çš„ class çš„é¼»ç¥–ï¼Œé»˜è®¤éƒ½æ˜¯æœ‰çš„ï¼Œç”©ä¸æ‰çš„ã€‚

é‚£æ—¢ç„¶æ˜¯ç™½ç»™çš„ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å¤§ç¤¼åŒ…é‡Œæœ‰ä»€ä¹ˆï¼Œè°·æ­Œ Object çš„ Oracle æ–‡æ¡£ï¼š

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79Snmo08lCBxiamQL31uE6kEDy1jBj61JXo493VkeAvaUCryrKKYlF8YOqW8Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

æ‰€ä»¥è¿™äº›æ–¹æ³•éƒ½æ˜¯å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨çš„å‘¢ï½

å›åˆ° hashCode() å’Œ equals()ï¼Œé‚£ä¹ˆå¦‚æœè¿™ä¸ªæ–°çš„ class é‡Œæ²¡æœ‰é‡å†™ (override) è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯é»˜è®¤ç»§æ‰¿ Object class é‡Œçš„å®šä¹‰äº†ã€‚

é‚£æˆ‘ä»¬ç‚¹è¿›å»æ¥çœ‹çœ‹ equals() æ˜¯æ€ä¹ˆå®šä¹‰çš„ï¼š

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoFPPlESsl7v26heTa32QIMKQaCZLZNicRCxVV7ic1gK0P9UndBibZupnibA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

è®°ç¬”è®°ï¼š

`equals()` æ–¹æ³•å°±æ˜¯æ¯”è¾ƒè¿™ä¸¤ä¸ª references æ˜¯å¦æŒ‡å‘äº†åŒä¸€ä¸ª object.

å—¯ï¼Ÿï¼Ÿï¼Ÿä½ åœ¨é€—æˆ‘å—ï¼Ÿï¼Ÿé‚£å²‚ä¸æ˜¯å’Œ `==` ä¸€æ ·äº†ï¼Ÿï¼Ÿ

> è¡¥å……ï¼š
> æˆ‘ä»¬å¸¸ç”¨çš„æ¯”è¾ƒå¤§å°çš„ç¬¦å·ä¹‹ `==`
> å¦‚æœæ˜¯ primitive typeï¼Œé‚£ä¹ˆ == å°±æ˜¯æ¯”è¾ƒæ•°å€¼çš„å¤§å°ï¼›
> å¦‚æœæ˜¯ reference typeï¼Œé‚£ä¹ˆå°±æ¯”è¾ƒçš„æ˜¯è¿™ä¸¤ä¸ª reference æ˜¯å¦æŒ‡å‘äº†åŒä¸€ä¸ª objectã€‚

> å†è¡¥å……ï¼š
> Java çš„æ•°æ®ç±»å‹å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š
> Primitive type æœ‰ä¸”ä»…æœ‰8ç§ï¼šbyte, short, int, long, float, double, char, boolean.
> å…¶ä»–éƒ½æ˜¯ Reference type.
> æ‰€ä»¥è™½ç„¶ Java å£°ç§° â€œEverything is objectâ€ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰é object æ•°æ®ç±»å‹çš„å­˜åœ¨çš„ã€‚

æˆ‘ä¸ä¿¡ï¼Œæˆ‘è¦å»æºç é‡Œçœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆå®ç°çš„ã€‚

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoqrblZm2aFhR6jeQrXia95nLibdHHlA98gtH3z3uDQC8Mkj56OwRYH3GQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

å“ˆï¼Œè¿˜çœŸæ˜¯çš„ï¼Œç»•äº†è¿™ä¹ˆåŠå¤©ï¼Œ`equals()` å°±æ˜¯ç”¨ `==` æ¥å®ç°çš„ï¼

é‚£ä¸ºä»€ä¹ˆè¿˜å¼„å‡ºæ¥è¿™ä¹ˆä¸ªæ–¹æ³•å‘¢ï¼Ÿ

**ç­”ï¼šä¸ºäº†è®©ä½  overrideï½**

æ¯”å¦‚ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬æ¯”è¾ƒå­—ç¬¦ä¸²å°±æ˜¯æƒ³æ¯”è¾ƒè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å†…å®¹çš„ï¼Œé‚£ä¹ˆï¼š

```java
str1 = â€œtianxiaoqiâ€;
str2 =  new String(â€œtianxiaoqiâ€);

str1 == str2; // return false
str1.equals(str2); // return true
```

å› ä¸º String é‡Œæ˜¯é‡å†™äº† equals() æ–¹æ³•çš„ï¼š

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79Snmo6eA8mxadX34qBmv5mia0cW2coajvnicGpTQ5QX6m2ibXICezmeFDSNUpg/640?wx_fmt=other&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

è€ç¥–å®—ç•™ç»™ä½ å°±æ˜¯è®©ä½ è‡ªå·±ç”¨çš„ï¼Œå¦‚æœä½ ä¸ç”¨ï¼Œé‚£äººå®¶ä¹Ÿæä¾›äº†é»˜è®¤çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯å¤Ÿæ„æ€äº†ã€‚

å¥½äº†ï¼Œæˆ‘ä»¬å†å»çœ‹ hashCode() çš„ä»‹ç»ï¼š

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoleQ7noJphTz8j0nVq7anpZmIsVKRBAJQEc1CicfZKW9JvaGcvHuIWeA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

é‚£è‡³äº hashCode() è¿”å›çš„ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Œå’Œæœ¬æ–‡å…³è”ä¸å¤ªå¤§ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥çœ‹å‚è€ƒ**è¿™ç¯‡æ–‡ç« **[1]ï¼Œç»“è®ºå°±æ˜¯ï¼š

> è¿”å›çš„å¹¶ä¸ä¸€å®šæ˜¯å¯¹è±¡çš„ï¼ˆè™šæ‹Ÿï¼‰å†…å­˜åœ°å€ï¼Œå…·ä½“å–å†³äºè¿è¡Œæ—¶åº“å’ŒJVMçš„å…·ä½“å®ç°ã€‚

ä½†æ— è®ºæ˜¯æ€ä¹ˆå®ç°çš„ï¼Œéƒ½éœ€è¦éµå¾ªæ–‡æ¡£ä¸Šçš„çº¦å®šï¼Œä¹Ÿå°±æ˜¯å¯¹ä¸åŒçš„ object ä¼šè¿”å›**å”¯ä¸€çš„å“ˆå¸Œå€¼**ã€‚

### å“ˆå¸Œå†²çªè¯¦è§£

ä¸€èˆ¬æ¥è¯´å“ˆå¸Œå†²çªæœ‰ä¸¤å¤§ç±»**è§£å†³æ–¹å¼**[2]

> 1. Separate chaining
> 2. Open addressing

Java ä¸­é‡‡ç”¨çš„æ˜¯ç¬¬ä¸€ç§ `Separate chaining`ï¼Œå³åœ¨å‘ç”Ÿç¢°æ’çš„é‚£ä¸ªæ¡¶åé¢å†åŠ ä¸€æ¡â€œé“¾â€æ¥å­˜å‚¨ï¼Œé‚£ä¹ˆè¿™ä¸ªâ€œé“¾â€ä½¿ç”¨çš„å…·ä½“æ˜¯ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Œä¸åŒçš„ç‰ˆæœ¬ç¨æœ‰ä¸åŒï¼š

> åœ¨ JDK1.6 å’Œ 1.7 ä¸­ï¼Œæ˜¯ç”¨**é“¾è¡¨**å­˜å‚¨çš„ï¼Œè¿™æ ·å¦‚æœç¢°æ’å¾ˆå¤šçš„è¯ï¼Œå°±å˜æˆäº†åœ¨é“¾è¡¨ä¸Šçš„æŸ¥æ‰¾ï¼Œworst case å°±æ˜¯ O(n)ï¼›

> åœ¨ JDK 1.8 è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦è¾ƒå¤§æ—¶ï¼ˆè¶…è¿‡ 8ï¼‰ï¼Œä¼šé‡‡ç”¨**çº¢é»‘æ ‘**æ¥å­˜å‚¨ï¼Œè¿™æ ·å¤§å¤§æé«˜äº†æŸ¥æ‰¾æ•ˆç‡ã€‚

ï¼ˆè¯è¯´ï¼Œè¿™ä¸ªè¿˜çœŸçš„å–œæ¬¢è€ƒï¼Œå·²ç»åœ¨å¤šæ¬¡é¢è¯•ä¸­è¢«é—®è¿‡äº†ï¼Œè¿˜æœ‰é¢è¯•å®˜é—®ä¸ºä»€ä¹ˆæ˜¯è¶…è¿‡â€œ8â€æ‰ç”¨çº¢é»‘æ ‘ğŸ¤”ï¼‰

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoIjDT5V3tMnsPo5h7h7rY6VKGgPt26andia0Q63eLtIgiaIvGq0aKdtoQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

ç¬¬äºŒç§æ–¹æ³• `open addressing` ä¹Ÿæ˜¯éå¸¸é‡è¦çš„æ€æƒ³ï¼Œå› ä¸ºåœ¨çœŸå®çš„åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œï¼Œæœ‰å¾ˆå¤šåœ°æ–¹ä¼šç”¨åˆ° hash çš„æ€æƒ³ä½†åˆä¸é€‚åˆç”¨ `seprate chaining`ã€‚

è¿™ç§æ–¹æ³•æ˜¯é¡ºåºæŸ¥æ‰¾ï¼Œå¦‚æœè¿™ä¸ªæ¡¶é‡Œå·²ç»è¢«å äº†ï¼Œé‚£å°±æŒ‰ç…§â€œ**æŸç§æ–¹å¼**â€ç»§ç»­æ‰¾ä¸‹ä¸€ä¸ªæ²¡æœ‰è¢«å çš„æ¡¶ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªç©ºçš„ã€‚

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoqbfHPmP9zK77xu9w1ZM6VCIB3v7OVxfKNG6BzHkWNU8G7vY5uFRSdA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

å¦‚å›¾æ‰€ç¤ºï¼ŒJohn Smith å’Œ Sandra Dee å‘ç”Ÿäº†å“ˆå¸Œå†²çªï¼Œéƒ½è¢«è®¡ç®—åˆ° 152 å·æ¡¶ï¼Œäºæ˜¯ Sandra å°±å»äº†ä¸‹ä¸€ä¸ªç©ºä½ - 153 å·æ¡¶ï¼Œå½“ç„¶ä¹Ÿä¼šå¯¹ä¹‹åçš„ key å‘ç”Ÿå½±å“ï¼šTed Baker è®¡ç®—ç»“æœæœ¬åº”æ˜¯æ”¾åœ¨ 153 å·çš„ï¼Œä½†é‰´äºå·²ç»è¢« Sandra å äº†ï¼Œå°±åªèƒ½å†å»ä¸‹ä¸€ä¸ªç©ºä½äº†ï¼Œæ‰€ä»¥åˆ°äº† 154 å·ã€‚

è¿™ç§æ–¹å¼å«åš `Linear probing` çº¿æ€§æ¢æŸ¥ï¼Œå°±åƒä¸Šå›¾æ‰€ç¤ºï¼Œä¸€ä¸ªä¸ªçš„é¡ºç€æ‰¾ä¸‹ä¸€ä¸ªç©ºä½ã€‚å½“ç„¶è¿˜æœ‰å…¶ä»–çš„æ–¹å¼ï¼Œæ¯”å¦‚å»æ‰¾å¹³æ–¹æ•°ï¼Œæˆ–è€… Double hashing.

## HashMap åŸºæœ¬æ“ä½œ

æ¯ç§æ•°æ®ç»“æ„çš„åŸºæœ¬æ“ä½œéƒ½æ— å¤–ä¹**å¢åˆ æ”¹æŸ¥**è¿™å››ç§ï¼Œå…·ä½“åˆ° HashMap æ¥è¯´ï¼Œ

> - å¢ï¼šput(K key, V value)
> - åˆ ï¼šremove(Object key)
> - æ”¹ï¼šè¿˜æ˜¯ç”¨çš„ put(K key, V value)
> - æŸ¥ï¼šget(Object key) / containsKey(Object key)

ç»†å¿ƒçš„åŒå­¦å¯èƒ½å‘ç°äº†ï¼Œä¸ºä»€ä¹ˆæœ‰äº› key çš„ç±»å‹æ˜¯ Objectï¼Œæœ‰äº›æ˜¯ K å‘¢ï¼Ÿè¿™è¿˜ä¸æ˜¯å› ä¸º equals()...

è¿™æ˜¯å› ä¸ºï¼Œåœ¨ get/remove çš„æ—¶å€™ï¼Œä¸ä¸€å®šæ˜¯ç”¨çš„åŒä¸€ä¸ª objectã€‚

è¿˜è®°å¾—é‚£ä¸ª str1 å’Œ str2 éƒ½æ˜¯ç”°å°é½çš„ä¾‹å­å—ï¼Ÿé‚£æ¯”å¦‚æˆ‘å…ˆ put(str1, value)ï¼Œç„¶åç”¨ get(str2) çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯æƒ³è¦åˆ° tianxiaoqi å¯¹åº”çš„ value å‘€ï¼ä¸èƒ½å› ä¸ºæˆ‘æ¢äº†èº«è¡£æœå°±ä¸è®¤å¾—æˆ‘äº†å‘€ï¼æ‰€ä»¥åœ¨ get/remove çš„æ—¶å€™å¹¶æ²¡æœ‰å¾ˆé™åˆ¶ key çš„ç±»å‹ï¼Œæ–¹ä¾¿å¦ä¸€ä¸ªè‡ªå·±ç›¸è®¤ã€‚

å…¶å®è¿™äº› API çš„æ“ä½œæµç¨‹å¤§åŒå°å¼‚ï¼Œæˆ‘ä»¬ä»¥æœ€å¤æ‚çš„ put(K key, V value) æ¥è®²ï¼š

1. é¦–å…ˆè¦æ‹¿åˆ° array ä¸­è¦æ”¾çš„ä½ç½®çš„ index

- æ€ä¹ˆæ‰¾ index å‘¢ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥å•ç‹¬ç”¨ getIndex() method æ¥åšè¿™ä»¶äº‹ï¼›
- å…·ä½“æ€ä¹ˆåšï¼Œå°±æ˜¯é€šè¿‡ hash function ç®—å‡ºæ¥çš„å€¼ï¼Œæ¨¡ä¸Šæ•°ç»„çš„é•¿åº¦ï¼›

2. é‚£æ‹¿åˆ°äº†è¿™ä¸ªä½ç½®çš„ Nodeï¼Œæˆ‘ä»¬å¼€å§‹ traverse è¿™ä¸ª LinkedListï¼Œè¿™å°±æ˜¯åœ¨é“¾è¡¨ä¸Šçš„æ“ä½œäº†ï¼Œ

- å¦‚æœæ‰¾çš„åˆ°ï¼Œå°±æ›´æ–°ä¸€ä¸‹ valueï¼›
- å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±æŠŠå®ƒæ”¾åœ¨é“¾è¡¨ä¸Šï¼Œå¯ä»¥æ”¾å¤´ä¸Šï¼Œä¹Ÿå¯ä»¥æ”¾å°¾ä¸Šï¼Œä¸€èˆ¬æˆ‘å–œæ¬¢æ”¾å¤´ä¸Šï¼Œå› ä¸ºæ–°åŠ å…¥çš„å…ƒç´ ç”¨åˆ°çš„æ¦‚ç‡æ€»æ˜¯å¤§ä¸€äº›ï¼Œä½†å¹¶ä¸å½±å“æ—¶é—´å¤æ‚åº¦ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```java
public V put(K key, V value) {  
    int index = getIndex(key);  
    Node<K, V> node = array[index];  
    Node<K, V> head = node;   
    while (node != null) {    
        // åŸæ¥æœ‰è¿™ä¸ª keyï¼Œä»…æ›´æ–°å€¼    
        if (checkEquals(key, node)) {      
            V preValue = node.value;      
            node.value = value;      
            return preValue;    
        }    
        node = node.next;  
    }  
    // åŸæ¥æ²¡æœ‰è¿™ä¸ª keyï¼Œæ–°åŠ è¿™ä¸ª 
    node  Node<K, V> newNode = new Node(key, value);   
    newNode.next = head;  
    array[index] = newNode;  
    return null;
}
```

è‡³äºæ›´å¤šçš„ç»†èŠ‚æ¯”å¦‚åŠ ä¸€äº› rehashing å•Šï¼Œload factor å•Šï¼Œå¤§å®¶å¯ä»¥å‚è€ƒæºç ã€‚

è¯»å®Œæºç å¤§å®¶å¯ä»¥åšåš Leetcode 706 é¢˜ç»ƒæ‰‹ï¼Œso easy~

### ä¸ Hashtable çš„åŒºåˆ«

è¿™æ˜¯ä¸€ä¸ªå¹´é¾„æš´éœ²è´´ï¼ŒHashMap ä¸ Hashtable çš„å…³ç³»ï¼Œå°±åƒ ArrayList ä¸ Vectorï¼Œä»¥åŠ StringBuilder ä¸ StringBufferã€‚

Hashtable æ˜¯æ—©æœŸ JDK æä¾›çš„æ¥å£ï¼ŒHashMap æ˜¯æ–°ç‰ˆçš„ï¼›å®ƒä»¬ä¹‹é—´æœ€æ˜¾è‘—çš„åŒºåˆ«ï¼Œå°±æ˜¯ Hashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒHashMap å¹¶éçº¿ç¨‹å®‰å…¨ã€‚

> è¿™æ˜¯å› ä¸º Java 5.0 ä¹‹åå…è®¸æ•°æ®ç»“æ„ä¸è€ƒè™‘çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼Œå› ä¸ºå®é™…å·¥ä½œä¸­æˆ‘ä»¬å‘ç°æ²¡æœ‰å¿…è¦åœ¨æ•°æ®ç»“æ„çš„å±‚é¢ä¸Šä¸Šé”ï¼ŒåŠ é”å’Œæ”¾é”åœ¨ç³»ç»Ÿä¸­æ˜¯æœ‰å¼€é”€çš„ï¼Œå†…éƒ¨é”æœ‰æ—¶å€™ä¼šæˆä¸ºç¨‹åºçš„ç“¶é¢ˆã€‚

æ‰€ä»¥ HashMap, ArrayList, StringBuilder ä¸å†è€ƒè™‘çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼Œæ€§èƒ½æå‡äº†å¾ˆå¤šï¼Œå½“ç„¶ï¼Œçº¿ç¨‹å®‰å…¨é—®é¢˜ä¹Ÿå°±è½¬ç§»ç»™æˆ‘ä»¬ç¨‹åºå‘˜äº†ã€‚

å¦å¤–ä¸€ä¸ªåŒºåˆ«å°±æ˜¯ï¼šHashMap å…è®¸ key ä¸­æœ‰ null å€¼ï¼ŒHashtable æ˜¯ä¸å…è®¸çš„ã€‚è¿™æ ·çš„å¥½å¤„å°±æ˜¯å¯ä»¥ç»™ä¸€ä¸ªé»˜è®¤å€¼ã€‚

å¥½äº†ï¼Œæœ€åæˆ‘ä»¬çœ‹ä¸‹å¸¸è€ƒé¢˜å§ã€‚

## Top K é—®é¢˜

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoPVLQ3hvibbtI7q2PSdYu6WFDjwYXmskeXdVGN0SLc7oZibP2GQK7Oshw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

éå¸¸å¸¸è€ƒçš„ Top K é—®é¢˜ï¼Œä¹Ÿæ˜¯å¤§å‚é¢è¯•ä¸­è§„ä¸­çŸ©çš„é¢˜ï¼Œè¿™ä¸¤é¢˜å¤§åŒå°å¼‚ï¼Œè¿™é‡Œä»¥ç¬¬ä¸€é¢˜ä¸ºä¾‹ã€‚

![img](https://mmbiz.qpic.cn/mmbiz_png/og5r7PHGHoj0WrWARcEiblANtyB79SnmoiaPdLA0cxic2xwoAAUkuBdp0zqXibWt0OvWcdpsrvYFqoOicgkTUPKDGkg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

> é¢˜æ„ï¼š
> ç»™ä¸€ç»„è¯ï¼Œç»Ÿè®¡å‡ºç°é¢‘ç‡æœ€é«˜çš„ k ä¸ªã€‚
> æ¯”å¦‚è¯´ â€œI love leetcode, I love codingâ€ ä¸­é¢‘ç‡æœ€é«˜çš„ 2 ä¸ªå°±æ˜¯ I å’Œ love äº†ã€‚

æœ‰åŒå­¦è§‰å¾—è¿™é¢˜ç‰¹åˆ«ç®€å•ï¼Œä½†å…¶å®è¿™é¢˜åªæ˜¯æ¯é¢˜ï¼Œå®ƒå¯ä»¥å‡çº§åˆ°**ç³»ç»Ÿè®¾è®¡**å±‚é¢æ¥é—®ï¼š

> åœ¨æŸç”µå•†ç½‘ç«™ä¸Šï¼Œè¿‡å»çš„ä¸€å°æ—¶å†…å–å‡ºçš„æœ€å¤šçš„ k ç§è´§ç‰©ã€‚

æˆ‘ä»¬å…ˆçœ‹ç®—æ³•å±‚é¢:

**æ€è·¯ï¼š**

ç»Ÿè®¡ä¸‹æ‰€æœ‰è¯çš„é¢‘ç‡ï¼Œç„¶åæŒ‰é¢‘ç‡æ’åºå–æœ€é«˜çš„å‰ k ä¸ªå‘—ã€‚

**ç»†èŠ‚ï¼š**

ç”¨ HashMap å­˜æ”¾å•è¯çš„é¢‘ç‡ï¼Œç”¨ minHeap/maxHeap æ¥å–å‰ k ä¸ªã€‚

**å®ç°ï¼š**

1. å»ºä¸€ä¸ª `HashMap <key = å•è¯ï¼Œvalue = å‡ºç°é¢‘ç‡>`ï¼Œéå†æ•´ä¸ªæ•°ç»„ï¼Œç›¸åº”çš„æŠŠè¿™ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•° + 1.

è¿™ä¸€æ­¥æ—¶é—´å¤æ‚åº¦æ˜¯ O(n).

1. ç”¨ size = k çš„ minHeap æ¥å­˜æ”¾ç»“æœï¼Œå®šä¹‰å¥½é¢˜ç›®ä¸­è§„å®šçš„æ¯”è¾ƒé¡ºåº
   a. é¦–å…ˆæŒ‰ç…§å‡ºç°çš„é¢‘ç‡æ’åºï¼›
   b. é¢‘ç‡ç›¸åŒæ—¶ï¼ŒæŒ‰å­—æ¯é¡ºåºã€‚
2. éå†è¿™ä¸ª mapï¼Œå¦‚æœ
   a. minHeap é‡Œé¢çš„å•è¯æ•°è¿˜ä¸åˆ° k ä¸ªçš„æ—¶å€™å°±åŠ è¿›å»ï¼›
   b. æˆ–è€…é‡åˆ°æ›´é«˜é¢‘çš„å•è¯å°±æŠŠå®ƒæ›¿æ¢æ‰ã€‚

**æ—¶ç©ºå¤æ‚åº¦åˆ†æï¼š**

ç¬¬ä¸€æ­¥æ˜¯ O(n)ï¼Œç¬¬ä¸‰æ­¥æ˜¯ nlog(k)ï¼Œæ‰€ä»¥åŠ åœ¨ä¸€èµ·æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlogk).

ç”¨äº†ä¸€ä¸ªé¢å¤–çš„ heap å’Œ mapï¼Œç©ºé—´å¤æ‚åº¦æ˜¯ O(n).

ä»£ç ï¼š

```java
class Solution {    
    public List<String> topKFrequent(String[] words, int k) {        
        // Step 1        
        Map<String, Integer> map = new HashMap<>();        
        for (String word : words) {            
            Integer count = map.getOrDefault(word, 0);            
            count++;            
            map.put(word, count);        
        }                
        // Step 2        
        PriorityQueue<Map.Entry<String, Integer>> minHeap = new PriorityQueue<>(k+1, new Comparator<Map.Entry<String, Integer>>() {            
            @Override            
            public int compare(Map.Entry<String, Integer> e1, Map.Entry<String, Integer> e2) {                
                if(e1.getValue() == e2.getValue()) {                    
                    return e2.getKey().compareTo(e1.getKey());               
                }                
                return e1.getValue().compareTo(e2.getValue());            
            }        
        });                
        // Step 3        
        List<String> res = new ArrayList<>();        
        for(Map.Entry<String, Integer> entry : map.entrySet()) {            						minHeap.offer(entry);            
            if(minHeap.size() > k) {                
                minHeap.poll();            
            }        
        }        
        while(!minHeap.isEmpty()) {            
            res.add(minHeap.poll().getKey());        
        }        
        Collections.reverse(res);        
        return res;    
    }
```

### å‚è€ƒèµ„æ–™

[1]hashCode()å‚è€ƒæ–‡ç« : *https://blog.csdn.net/xusiwei1236/article/details/45152201*[2]å“ˆå¸Œå†²çªwiki: *https://en.wikipedia.org/wiki/Hash_table*